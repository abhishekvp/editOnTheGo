(function(){var e=function(e,t){this.parentNode==t.lastElementChild&&(t.firstElementChild.value=this.textContent,t.firstElementChild.nextSibling.value=JSON.stringify(this.xtag.data),t.xtag.hideSuggestions(),t.firstElementChild.focus(),xtag.fireEvent(t,"change"))};xtag.register("x-autosuggest",{content:'<input type="text" /><input type="hidden" /><ul></ul>',mixins:["request"],getters:{value:function(){return this.firstElementChild.value}},setters:{name:function(e){this.firstElementChild.name=e,this.firstElementChild.nextElementSibling.name=e,this.setAttribute("name",e)}},events:{"dataready:preventable":function(){this.xtag.clearSuggestions(),this.xtag.showSuggestions()},"keydown:keypass(38, 40)":function(e,t){e.preventDefault(),this.xtag.showSuggestions();var n=t.lastElementChild.firstElementChild;if(!n)return t;var r=xtag.query(t,'[selected="true"]')[0];r?(e.keyCode-38?r.nextElementSibling||n:r.previousElementSibling||t.lastElementChild.lastElementChild).focus():n.focus()},"keyup:delegate(input):keystop(9, 13, 16, 17, 32, 37, 38, 39, 40, 91)":function(e,t){var n=t.getAttribute("data-url"),r=t.getAttribute("data-padding")||1;n&&this.value.length>=r&&(t.src=n)},"keyup:delegate(li):keypass(13)":e,"click:delegate(li)":e,"focus:delegate(li)":function(){xtag.query(this.parentNode,'[selected="true"]').forEach(function(e){e.removeAttribute("selected")}),this.setAttribute("selected",!0)},blur:function(e,t){setTimeout(function(){t!=document.activeElement&&!t.contains(document.activeElement)&&t.xtag.hideSuggestions()},1)}},methods:{addSuggestion:function(e,t){var n=document.createElement("li");n.setAttribute("tabindex",0),n.innerHTML=e,n.xtag={data:t},this.lastElementChild.appendChild(n)},clearSuggestions:function(){this.lastElementChild.innerHTML=""},showSuggestions:function(){this.lastElementChild.setAttribute("data-show-suggestions",!0)},hideSuggestions:function(){this.lastElementChild.removeAttribute("data-show-suggestions")}}})})()